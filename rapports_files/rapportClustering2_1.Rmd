---
title: "RAPPORT"
author: "SAMA Fousseni"
date: "22/05/2022"
output: word_document
---

```{r message=FALSE, warning=FALSE}
# Chargement de packages
library("tidyverse")
library("FactoMineR")
library("factoextra")
library("ggpubr")

load("rdata/cells_matrix.rda")
cells_data_bind <- cells_matrix[[1]]
for (b in 2:16) {
  cells_data_bind <- cbind(
    cells_data_bind,
    cells_matrix[[b]] 
  )
}

nb_class_max = 50
nb_class_min = 5
```


# Construction de clustering en retirant les CRHs qui ne se retrouvent que dans 1 cellules

```{r message=FALSE, warning=FALSE}
cells_data <- cells_data_bind[, apply(cells_data_bind, 2, sum)>1, drop = FALSE]
dim(cells_data)

cells_data[cells_data == 1] <- "in"
cells_data[cells_data == 0] <- "Not in"

cells_data <- data.frame(cells_data)

res.mca <- MCA(cells_data, graph = FALSE)
eig.val <- get_eigenvalue(res.mca)
fviz_mca_ind(res.mca, col.ind = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), repel = TRUE, ggtheme = theme_minimal())
which(res.mca$eig[, 3, drop = FALSE]>=70)[1:5]

res.mca_ <- MCA(cells_data, ncp = 82, graph = FALSE)
hcpc_cluster <- HCPC(res.mca_, kk=Inf, min = nb_class_min, max = nb_class_max, graph = FALSE)
fviz_cluster(hcpc_cluster, repel = TRUE, geom = "point", main = "Classification après avoir retirer les CRHs qu'on \n ne retrouve que dans une cellule")
```


# Construction de clustering en retirant les CRHs qui ne se retrouvent que dans 2 cellules

```{r message=FALSE, warning=FALSE}
cells_data <- cells_data_bind[, apply(cells_data_bind, 2, sum)>2, drop = FALSE]
dim(cells_data)

cells_data[cells_data == 1] <- "in"
cells_data[cells_data == 0] <- "Not in"

cells_data <- data.frame(cells_data)

res.mca <- MCA(cells_data, graph = FALSE)
eig.val <- get_eigenvalue(res.mca)
fviz_mca_ind(res.mca, col.ind = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), repel = TRUE, ggtheme = theme_minimal())
which(res.mca$eig[, 3, drop = FALSE]>=70)[1:5]

res.mca_ <- MCA(cells_data, ncp = 82, graph = FALSE)
hcpc_cluster <- HCPC(res.mca_, kk=Inf, min = nb_class_min, max = nb_class_max, graph = FALSE)
fviz_cluster(hcpc_cluster, repel = TRUE, geom = "point", main = "Classification après avoir retirer les CRHs qu'on \n ne retrouve que dans deux cellules")
```


# Construction de clustering en retirant les CRHs qui ne se retrouvent que dans 3 cellules

```{r message=FALSE, warning=FALSE}
cells_data <- cells_data_bind[, apply(cells_data_bind, 2, sum)>3, drop = FALSE]
dim(cells_data)

cells_data[cells_data == 1] <- "in"
cells_data[cells_data == 0] <- "Not in"

cells_data <- data.frame(cells_data)

res.mca <- MCA(cells_data, graph = FALSE)
eig.val <- get_eigenvalue(res.mca)
fviz_mca_ind(res.mca, col.ind = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), repel = TRUE, ggtheme = theme_minimal())
which(res.mca$eig[, 3, drop = FALSE]>=70)[1:5]

res.mca_ <- MCA(cells_data, ncp = 82, graph = FALSE)
hcpc_cluster <- HCPC(res.mca_, kk=Inf, min = nb_class_min, max = nb_class_max, graph = FALSE)
fviz_cluster(hcpc_cluster, repel = TRUE, geom = "point", main = "Classification après avoir retirer les CRHs qu'on \n ne retrouve que dans trois cellules")
```


# Construction de clustering en retirant les CRHs qui ne se retrouvent que dans 4 cellules

```{r message=FALSE, warning=FALSE}
cells_data <- cells_data_bind[, apply(cells_data_bind, 2, sum)>4, drop = FALSE]
dim(cells_data)

cells_data[cells_data == 1] <- "in"
cells_data[cells_data == 0] <- "Not in"

cells_data <- data.frame(cells_data)

res.mca <- MCA(cells_data, graph = FALSE)
eig.val <- get_eigenvalue(res.mca)
fviz_mca_ind(res.mca, col.ind = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), repel = TRUE, ggtheme = theme_minimal())
which(res.mca$eig[, 3, drop = FALSE]>=70)[1:5]

res.mca_ <- MCA(cells_data, ncp = 82, graph = FALSE)
hcpc_cluster <- HCPC(res.mca_, kk=Inf, min = nb_class_min, max = nb_class_max, graph = FALSE)
fviz_cluster(hcpc_cluster, repel = TRUE, geom = "point", main = "Classification après avoir retirer les CRHs qu'on \n ne retrouve que dans quatre cellule")
```



# Construction de clustering en retirant les CRHs qui ne se retrouvent que dans 5 cellules

```{r message=FALSE, warning=FALSE}
cells_data <- cells_data_bind[, apply(cells_data_bind, 2, sum)>5, drop = FALSE]
dim(cells_data)

cells_data[cells_data == 1] <- "in"
cells_data[cells_data == 0] <- "Not in"

cells_data <- data.frame(cells_data)

res.mca <- MCA(cells_data, graph = FALSE)
eig.val <- get_eigenvalue(res.mca)
fviz_mca_ind(res.mca, col.ind = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), repel = TRUE, ggtheme = theme_minimal())
which(res.mca$eig[, 3, drop = FALSE]>=70)[1:5]

res.mca_ <- MCA(cells_data, ncp = 82, graph = FALSE)
hcpc_cluster <- HCPC(res.mca_, kk=Inf, min = nb_class_min, max = nb_class_max, graph = FALSE)
fviz_cluster(hcpc_cluster, repel = TRUE, geom = "point", main = "Classification après avoir retirer les CRHs qu'on \n ne retrouve que dans cinq cellule")
```



